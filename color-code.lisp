;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;; LispFurc
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;; Copyright 2015, Michal "phoe" Herda.
;;;;
;;;; The whole project is licensed under GPLv3.
;;;;

(in-package #:lispfurc)

;;;;=========================================================
;;;; COLOR CODE HELPER FUNCTIONS

(let
    ((color-table-1 ;; Used for fur and markings.
      '((0 "Cat Gray" (#(147 135 135) #(135 123 123) #(119 107 107) #(107 95 95) #(91 79 79) #(79 67 67) #(63 55 55) #(51 43 43)))
	(1 "Arctic" (#(219 223 247) #(199 203 231) #(179 187 219) #(163 171 207) #(143 151 187) #(123 131 167) #(103 115 151) #(51 39 99)))
	(2 "Black" (#(79 67 67) #(79 67 67) #(63 55 55) #(63 55 55) #(51 43 43) #(51 43 43) #(23 19 19) #(23 19 19)))
	(3 "Mule Tan" (#(159 147 139) #(147 135 127) #(135 123 115) #(123 111 103) #(115 103 95) #(103 91 83) #(91 79 71) #(83 71 63)))
	(4 "Dust" (#(155 143 99) #(139 127 87) #(127 115 75) #(115 103 67) #(103 91 55) #(91 79 47) #(79 67 39) #(67 55 31)))
	(5 "Chocolate" (#(147 87 87) #(135 75 75) #(123 63 63) #(111 51 51) #(99 43 43) #(87 31 31) #(75 23 23) #(63 19 19)))
	(6 "Lavender" (#(239 231 243) #(231 219 235) #(207 191 215) #(183 163 195) #(163 135 175) #(143 111 155) #(123 91 135) #(103 71 115)))
	(7 "Wolf Gray" (#(251 211 255) #(235 187 235) #(215 163 207) #(195 143 183) #(179 123 159) #(159 103 135) #(139 87 111) #(123 71 91)))
	(8 "Fox Orange" (#(255 227 207) #(247 195 155) #(243 163 107) #(235 135 63) #(211 111 39) #(187 91 23) #(163 71 7) #(139 55 0)))
	(9 "Horse Brown" (#(231 211 215) #(211 163 175) #(191 123 135) #(171 91 103) #(151 59 75) #(131 35 47) #(115 15 27) #(95 0 11)))
	(10 "Tawny" (#(219 183 163) #(207 163 135) #(195 143 111) #(183 119 79) #(163 107 79) #(143 95 79) #(135 75 75) #(147 87 87)))
	(11 "Mocha" (#(219 187 187) #(207 167 167) #(183 135 135) #(171 119 119) #(159 103 103) #(147 87 87) #(135 75 75) #(111 51 51)))
	(12 "Ruddy" (#(247 195 155) #(243 163 107) #(235 135 63) #(211 111 39) #(187 91 23) #(199 23 23) #(163 71 7) #(151 59 75)))
	(13 "Cream" (#(239 235 203) #(227 223 187) #(215 207 171) #(203 195 155) #(191 179 139) #(179 167 127) #(195 151 151) #(171 119 119)))
	(14 "Yellow" (#(255 251 235) #(251 235 183) #(247 223 135) #(243 215 91) #(219 187 71) #(199 159 51) #(175 135 39) #(155 111 27)))
	(15 "Grass Green" (#(131 195 115) #(111 175 91) #(95 155 67) #(79 139 47) #(63 119 31) #(51 99 19) #(43 83 11) #(39 71 7)))
	(16 "Burgundy" (#(255 175 195) #(239 127 159) #(227 79 127) #(211 39 103) #(199 7 83) #(171 7 71) #(143 11 63) #(111 7 47)))
	(17 "Pinewood" (#(247 231 231) #(235 207 207) #(219 187 187) #(195 151 151) #(171 119 119) #(147 87 87) #(135 75 75) #(123 63 63)))
	(18 "Sea Blue" (#(235 243 255) #(183 203 231) #(143 171 207) #(103 139 187) #(71 111 163) #(43 87 143) #(23 67 119) #(7 51 99)))
	(19 "Violet" (#(235 215 243) #(207 167 223) #(183 127 203) #(163 91 183) #(147 63 167) #(127 35 147) #(111 15 127) #(95 0 111)))
	(20 "Red" (#(255 55 55) #(255 55 55) #(227 39 39) #(227 39 39) #(199 23 23) #(171 11 11) #(143 7 7) #(99 0 0)))
	(21 "White" (#(255 255 255) #(247 247 247) #(243 239 235) #(231 227 227) #(219 211 211) #(195 183 179) #(159 147 139) #(123 111 103)))
	(22 "Navy" (#(211 199 223) #(179 163 203) #(151 131 183) #(123 103 163) #(99 79 143) #(83 67 131) #(63 47 111) #(43 31 91)))
	(23 "Cloudy Gray" (#(203 195 195) #(191 179 179) #(175 167 167) #(163 151 151) #(147 135 135) #(135 123 123) #(119 107 107) #(107 95 95)))
	(24 "Royal Blue" (#(139 191 243) #(119 147 247) #(103 99 255) #(75 71 227) #(47 47 199) #(27 27 175) #(11 11 147) #(0 0 123)))) )
     
     (color-table-2 ;; Used for hair.
      '((0 "Blood Red" (#(199 23 23) #(199 23 23) #(171 11 11) #(171 11 11) #(143 7 7) #(143 7 7) #(99 0 0) #(99 0 0)))
	(1 "Courage Red" (#(255 55 55) #(255 55 55) #(227 39 39) #(227 39 39) #(199 23 23) #(199 23 23) #(171 11 11) #(171 11 11)))
	(2 "Merry Red" (#(255 55 55) #(255 55 55) #(255 55 55) #(255 55 55) #(255 55 55) #(255 55 55) #(227 39 39) #(227 39 39)))
	(3 "Ember Orange" (#(243 163 107) #(243 163 107) #(235 135 63) #(235 135 63) #(255 95 27) #(255 95 27) #(187 91 23) #(187 91 23)))
	(4 "Hearty Brown" (#(171 7 71) #(171 7 71) #(143 11 63) #(143 11 63) #(111 7 47) #(111 7 47) #(75 23 23) #(75 23 23)))
	(5 "Burnt Orange" (#(187 91 23) #(187 91 23) #(163 71 7) #(163 71 7) #(139 55 0) #(139 55 0) #(111 51 51) #(111 51 51)))
	(6 "Busy Orange" (#(235 135 63) #(235 135 63) #(211 111 39) #(211 111 39) #(187 91 23) #(187 91 23) #(163 71 7) #(163 71 7)))
	(7 "August Orange" (#(247 195 155) #(247 195 155) #(243 163 107) #(243 163 107) #(235 135 63) #(235 135 63) #(211 111 39) #(211 111 39)))
	(8 "Noble Brown" (#(171 111 79) #(171 111 79) #(155 103 79) #(155 103 79) #(147 95 79) #(147 95 79) #(123 63 63) #(123 63 63)))
	(9 "Mahogany" (#(171 91 103) #(171 91 103) #(151 59 75) #(151 59 75) #(131 35 47) #(131 35 47) #(115 15 27) #(115 15 27)))
	(10 "Clever Maize" (#(199 159 51) #(199 159 51) #(175 135 39) #(175 135 39) #(155 111 27) #(155 111 27) #(107 95 19) #(107 95 19)))
	(11 "Pure Gold" (#(251 235 183) #(251 235 183) #(247 223 135) #(247 223 135) #(243 215 91) #(243 215 91) #(219 187 71) #(219 187 71)))
	(12 "Moon Yellow" (#(255 251 235) #(255 251 235) #(251 235 183) #(251 235 183) #(251 235 183) #(251 235 183) #(247 223 135) #(247 223 135)))
	(13 "Sun Yellow" (#(255 251 235) #(255 251 235) #(251 235 183) #(251 235 183) #(255 239 7) #(255 239 7) #(219 187 71) #(219 187 71)))
	(14 "Tan" (#(183 195 115) #(183 195 115) #(175 151 79) #(175 151 79) #(175 151 79) #(175 151 79) #(159 139 63) #(159 139 63)))
	(15 "Woodland Green" (#(95 143 47) #(95 143 47) #(79 123 31) #(79 123 31) #(67 103 19) #(67 103 19) #(55 83 11) #(55 83 11)))
	(16 "Friendly Green" (#(111 175 91) #(111 175 91) #(95 155 67) #(95 155 67) #(79 139 47) #(79 139 47) #(63 119 31) #(63 119 31)))
	(17 "Lucky Green" (#(163 223 131) #(163 223 131) #(131 195 115) #(131 195 115) #(111 175 91) #(111 175 91) #(95 155 67) #(95 155 67)))
	(18 "Travelers Green" (#(163 223 131) #(163 223 131) #(163 223 131) #(163 223 131) #(151 215 11) #(151 215 11) #(123 183 83) #(123 183 83)))
	(19 "Aquacyan" (#(0 135 139) #(0 135 139) #(0 135 139) #(0 135 139) #(0 135 139) #(0 135 139) #(71 111 163) #(71 111 163)))
	(20 "Deepsea Blue" (#(71 111 163) #(71 111 163) #(43 87 143) #(43 87 143) #(23 67 119) #(23 67 119) #(7 51 99) #(7 51 99)))
	(21 "Proud Blue" (#(103 139 187) #(103 139 187) #(71 111 163) #(71 111 163) #(43 87 143) #(43 87 143) #(23 67 119) #(23 67 119)))
	(22 "Lightsky Blue" (#(183 203 231) #(183 203 231) #(143 171 207) #(143 171 207) #(103 139 187) #(103 139 187) #(71 111 163) #(71 111 163)))
	(23 "Syndira Blue" (#(103 99 255) #(103 99 255) #(0 0 0) #(0 0 0) #(0 0 0) #(0 0 0) #(47 47 199) #(47 47 199)))
	(24 "Straight Blue" (#(47 47 199) #(47 47 199) #(27 27 175) #(27 27 175) #(11 11 147) #(11 11 147) #(0 0 123) #(0 0 123)))
	(25 "Royal Purple" (#(147 63 167) #(147 63 167) #(127 35 147) #(127 35 147) #(111 15 127) #(111 15 127) #(63 55 55) #(63 55 55)))
	(26 "Lonely Orchid" (#(183 127 203) #(183 127 203) #(163 91 183) #(163 91 183) #(147 63 167) #(147 63 167) #(127 35 147) #(127 35 147)))
	(27 "Spiritual Purple" (#(235 215 243) #(235 215 243) #(207 167 223) #(207 167 223) #(183 127 203) #(183 127 203) #(163 91 183) #(163 91 183)))
	(28 "Mad Green" (#(243 239 159) #(243 239 159) #(151 215 11) #(151 215 11) #(151 215 11) #(151 215 11) #(107 163 63) #(107 163 63)))
	(29 "Royal Blue" (#(75 71 227) #(75 71 227) #(47 47 199) #(47 47 199) #(27 27 175) #(27 27 175) #(11 11 147) #(11 11 147)))
	(30 "Passion" (#(211 39 103) #(211 39 103) #(199 7 83) #(199 7 83) #(171 7 71) #(171 7 71) #(143 11 63) #(143 11 63)))
	(31 "Bliss Red" (#(239 127 159) #(239 127 159) #(227 79 127) #(227 79 127) #(211 39 103) #(211 39 103) #(199 7 83) #(199 7 83)))
	(32 "Blush Pink" (#(255 227 207) #(255 227 207) #(255 175 195) #(255 175 195) #(239 127 159) #(239 127 159) #(227 79 127) #(227 79 127)))
	(33 "Twilight Sigh" (#(235 187 235) #(235 187 235) #(215 163 207) #(215 163 207) #(195 143 183) #(195 143 183) #(179 123 159) #(179 123 159)))
	(34 "Dreamer Blue" (#(103 99 255) #(103 99 255) #(103 99 255) #(103 99 255) #(75 71 227) #(75 71 227) #(47 47 199) #(47 47 199)))
	(35 "Shadow Gray" (#(143 111 155) #(143 111 155) #(123 91 135) #(123 91 135) #(103 71 115) #(103 71 115) #(79 67 67) #(79 67 67)))
	(36 "Neutral Gray" (#(163 135 175) #(163 135 175) #(143 111 155) #(143 111 155) #(123 91 135) #(123 91 135) #(103 71 115) #(103 71 115)))
	(37 "Tragic Gray" (#(183 163 195) #(183 163 195) #(163 135 175) #(163 135 175) #(143 111 155) #(143 111 155) #(123 91 135) #(123 91 135)))
	(38 "Winter Gray" (#(203 199 239) #(203 199 239) #(175 171 223) #(175 171 223) #(151 143 207) #(151 143 207) #(135 115 191) #(135 115 191)))
	(39 "Indigo" (#(63 47 111) #(63 47 111) #(51 39 99) #(51 39 99) #(43 31 91) #(43 31 91) #(43 31 91) #(43 31 91)))
	(40 "Black" (#(135 123 123) #(135 123 123) #(107 95 95) #(107 95 95) #(79 67 67) #(79 67 67) #(63 55 55) #(63 55 55)))
	(41 "Cloudy Gray" (#(203 195 195) #(203 195 195) #(175 167 167) #(175 167 167) #(163 151 151) #(163 151 151) #(135 123 123) #(135 123 123)))
	(42 "White" (#(255 255 255) #(255 255 255) #(243 239 235) #(243 239 235) #(219 211 211) #(219 211 211) #(159 147 139) #(159 147 139)))
	(43 "Pinewood" (#(247 231 231) #(247 231 231) #(219 187 187) #(219 187 187) #(171 119 119) #(171 119 119) #(135 75 75) #(135 75 75)))
	(44 "Green Yellow" (#(255 255 255) #(255 255 255) #(219 231 211) #(219 231 211) #(187 207 171) #(187 207 171) #(155 183 139) #(155 183 139)))))
     
     (color-table-3 ;; Used for eyes.
      '((0 "Blood Red" (#(199 23 23) #(199 23 23) #(171 11 11) #(171 11 11) #(143 7 7) #(143 7 7) #(99 0 0) #(99 0 0)))
	(1 "Courage Red" (#(255 55 55) #(255 55 55) #(227 39 39) #(227 39 39) #(199 23 23) #(199 23 23) #(171 11 11) #(171 11 11)))
	(2 "Merry Red" (#(255 55 55) #(255 55 55) #(255 55 55) #(255 55 55) #(255 55 55) #(255 55 55) #(227 39 39) #(227 39 39)))
	(3 "Ember Orange" (#(243 163 107) #(243 163 107) #(235 135 63) #(235 135 63) #(255 95 27) #(255 95 27) #(187 91 23) #(187 91 23)))
	(4 "Hearty Brown" (#(171 7 71) #(171 7 71) #(143 11 63) #(143 11 63) #(111 7 47) #(111 7 47) #(75 23 23) #(75 23 23)))
	(5 "Burnt Orange" (#(187 91 23) #(187 91 23) #(163 71 7) #(163 71 7) #(139 55 0) #(139 55 0) #(111 51 51) #(111 51 51)))
	(6 "Busy Orange" (#(235 135 63) #(235 135 63) #(211 111 39) #(211 111 39) #(187 91 23) #(187 91 23) #(163 71 7) #(163 71 7)))
	(7 "August Orange" (#(247 195 155) #(247 195 155) #(243 163 107) #(243 163 107) #(235 135 63) #(235 135 63) #(211 111 39) #(211 111 39)))
	(8 "Noble Brown" (#(171 111 79) #(171 111 79) #(155 103 79) #(155 103 79) #(147 95 79) #(147 95 79) #(123 63 63) #(123 63 63)))
	(9 "Mahogany" (#(171 91 103) #(171 91 103) #(151 59 75) #(151 59 75) #(131 35 47) #(131 35 47) #(115 15 27) #(115 15 27)))
	(10 "Clever Maize" (#(199 159 51) #(199 159 51) #(175 135 39) #(175 135 39) #(155 111 27) #(155 111 27) #(107 95 19) #(107 95 19)))
	(11 "Pure Gold" (#(251 235 183) #(251 235 183) #(247 223 135) #(247 223 135) #(243 215 91) #(243 215 91) #(219 187 71) #(219 187 71)))
	(12 "Moon Yellow" (#(255 251 235) #(255 251 235) #(251 235 183) #(251 235 183) #(251 235 183) #(251 235 183) #(247 223 135) #(247 223 135)))
	(13 "Sun Yellow" (#(255 251 235) #(255 251 235) #(251 235 183) #(251 235 183) #(255 239 7) #(255 239 7) #(219 187 71) #(219 187 71)))
	(14 "Tan" (#(183 195 115) #(183 195 115) #(175 151 79) #(175 151 79) #(175 151 79) #(175 151 79) #(159 139 63) #(159 139 63)))
	(15 "Woodland Green" (#(95 143 47) #(95 143 47) #(79 123 31) #(79 123 31) #(67 103 19) #(67 103 19) #(55 83 11) #(55 83 11)))
	(16 "Friendly Green" (#(111 175 91) #(111 175 91) #(95 155 67) #(95 155 67) #(79 139 47) #(79 139 47) #(63 119 31) #(63 119 31)))
	(17 "Lucky Green" (#(163 223 131) #(163 223 131) #(131 195 115) #(131 195 115) #(111 175 91) #(111 175 91) #(95 155 67) #(95 155 67)))
	(18 "Travelers Green" (#(163 223 131) #(163 223 131) #(163 223 131) #(163 223 131) #(151 215 11) #(151 215 11) #(123 183 83) #(123 183 83)))
	(19 "Aquacyan" (#(0 135 139) #(0 135 139) #(0 135 139) #(0 135 139) #(0 135 139) #(0 135 139) #(71 111 163) #(71 111 163)))
	(20 "Deepsea Blue" (#(71 111 163) #(71 111 163) #(43 87 143) #(43 87 143) #(23 67 119) #(23 67 119) #(7 51 99) #(7 51 99)))
	(21 "Proud Blue" (#(103 139 187) #(103 139 187) #(71 111 163) #(71 111 163) #(43 87 143) #(43 87 143) #(23 67 119) #(23 67 119)))
	(22 "Lightsky Blue" (#(183 203 231) #(183 203 231) #(143 171 207) #(143 171 207) #(103 139 187) #(103 139 187) #(71 111 163) #(71 111 163)))
	(23 "Syndira Blue" (#(103 99 255) #(103 99 255) #(0 0 0) #(0 0 0) #(0 0 0) #(0 0 0) #(47 47 199) #(47 47 199)))
	(24 "Straight Blue" (#(47 47 199) #(47 47 199) #(27 27 175) #(27 27 175) #(11 11 147) #(11 11 147) #(0 0 123) #(0 0 123)))
	(25 "Royal Purple" (#(147 63 167) #(147 63 167) #(127 35 147) #(127 35 147) #(111 15 127) #(111 15 127) #(63 55 55) #(63 55 55)))
	(26 "Lonely Orchid" (#(183 127 203) #(183 127 203) #(163 91 183) #(163 91 183) #(147 63 167) #(147 63 167) #(127 35 147) #(127 35 147)))
	(27 "Spiritual Purple" (#(235 215 243) #(235 215 243) #(207 167 223) #(207 167 223) #(183 127 203) #(183 127 203) #(163 91 183) #(163 91 183)))
	(28 "Mad Green" (#(243 239 159) #(243 239 159) #(151 215 11) #(151 215 11) #(151 215 11) #(151 215 11) #(107 163 63) #(107 163 63)))
	(29 "Royal Blue" (#(75 71 227) #(75 71 227) #(47 47 199) #(47 47 199) #(27 27 175) #(27 27 175) #(11 11 147) #(11 11 147)))))
     
     (color-table-4 ;; Used for badge.
      '((0 "Blood Red" (#(199 23 23) #(199 23 23) #(171 11 11) #(171 11 11) #(143 7 7) #(143 7 7) #(99 0 0) #(99 0 0)))
	(1 "Courage Red" (#(255 55 55) #(255 55 55) #(227 39 39) #(227 39 39) #(199 23 23) #(199 23 23) #(171 11 11) #(171 11 11)))
	(2 "Merry Red" (#(255 55 55) #(255 55 55) #(255 55 55) #(255 55 55) #(255 55 55) #(255 55 55) #(227 39 39) #(227 39 39)))
	(3 "Ember Orange" (#(243 163 107) #(243 163 107) #(235 135 63) #(235 135 63) #(255 95 27) #(255 95 27) #(187 91 23) #(187 91 23)))
	(4 "Hearty Brown" (#(171 7 71) #(171 7 71) #(143 11 63) #(143 11 63) #(111 7 47) #(111 7 47) #(75 23 23) #(75 23 23)))
	(5 "Burnt Orange" (#(187 91 23) #(187 91 23) #(163 71 7) #(163 71 7) #(139 55 0) #(139 55 0) #(111 51 51) #(111 51 51)))
	(6 "Busy Orange" (#(235 135 63) #(235 135 63) #(211 111 39) #(211 111 39) #(187 91 23) #(187 91 23) #(163 71 7) #(163 71 7)))
	(7 "August Orange" (#(247 195 155) #(247 195 155) #(243 163 107) #(243 163 107) #(235 135 63) #(235 135 63) #(211 111 39) #(211 111 39)))
	(8 "Noble Brown" (#(171 111 79) #(171 111 79) #(155 103 79) #(155 103 79) #(147 95 79) #(147 95 79) #(123 63 63) #(123 63 63)))
	(9 "Mahogany" (#(171 91 103) #(171 91 103) #(151 59 75) #(151 59 75) #(131 35 47) #(131 35 47) #(115 15 27) #(115 15 27)))
	(10 "Clever Maize" (#(199 159 51) #(199 159 51) #(175 135 39) #(175 135 39) #(155 111 27) #(155 111 27) #(107 95 19) #(107 95 19)))
	(11 "Pure Gold" (#(251 235 183) #(251 235 183) #(247 223 135) #(247 223 135) #(243 215 91) #(243 215 91) #(219 187 71) #(219 187 71)))
	(12 "Moon Yellow" (#(255 251 235) #(255 251 235) #(251 235 183) #(251 235 183) #(251 235 183) #(251 235 183) #(247 223 135) #(247 223 135)))
	(13 "Sun Yellow" (#(255 251 235) #(255 251 235) #(251 235 183) #(251 235 183) #(255 239 7) #(255 239 7) #(219 187 71) #(219 187 71)))
	(14 "Tan" (#(183 195 115) #(183 195 115) #(175 151 79) #(175 151 79) #(175 151 79) #(175 151 79) #(159 139 63) #(159 139 63)))
	(15 "Woodland Green" (#(95 143 47) #(95 143 47) #(79 123 31) #(79 123 31) #(67 103 19) #(67 103 19) #(55 83 11) #(55 83 11)))
	(16 "Friendly Green" (#(111 175 91) #(111 175 91) #(95 155 67) #(95 155 67) #(79 139 47) #(79 139 47) #(63 119 31) #(63 119 31)))
	(17 "Lucky Green" (#(163 223 131) #(163 223 131) #(131 195 115) #(131 195 115) #(111 175 91) #(111 175 91) #(95 155 67) #(95 155 67)))
	(18 "Travelers Green" (#(163 223 131) #(163 223 131) #(163 223 131) #(163 223 131) #(151 215 11) #(151 215 11) #(123 183 83) #(123 183 83)))
	(19 "Aquacyan" (#(0 135 139) #(0 135 139) #(0 135 139) #(0 135 139) #(0 135 139) #(0 135 139) #(71 111 163) #(71 111 163)))
	(20 "Deepsea Blue" (#(71 111 163) #(71 111 163) #(43 87 143) #(43 87 143) #(23 67 119) #(23 67 119) #(7 51 99) #(7 51 99)))
	(21 "Proud Blue" (#(103 139 187) #(103 139 187) #(71 111 163) #(71 111 163) #(43 87 143) #(43 87 143) #(23 67 119) #(23 67 119)))
	(22 "Lightsky Blue" (#(183 203 231) #(183 203 231) #(143 171 207) #(143 171 207) #(103 139 187) #(103 139 187) #(71 111 163) #(71 111 163)))
	(23 "Syndira Blue" (#(103 99 255) #(103 99 255) #(0 0 0) #(0 0 0) #(0 0 0) #(0 0 0) #(47 47 199) #(47 47 199)))
	(24 "Straight Blue" (#(47 47 199) #(47 47 199) #(27 27 175) #(27 27 175) #(11 11 147) #(11 11 147) #(0 0 123) #(0 0 123)))
	(25 "Royal Purple" (#(147 63 167) #(147 63 167) #(127 35 147) #(127 35 147) #(111 15 127) #(111 15 127) #(63 55 55) #(63 55 55)))
	(26 "Lonely Orchid" (#(183 127 203) #(183 127 203) #(163 91 183) #(163 91 183) #(147 63 167) #(147 63 167) #(127 35 147) #(127 35 147)))
	(27 "Spiritual Purple" (#(235 215 243) #(235 215 243) #(207 167 223) #(207 167 223) #(183 127 203) #(183 127 203) #(163 91 183) #(163 91 183)))
	(28 "Mad Green" (#(243 239 159) #(243 239 159) #(151 215 11) #(151 215 11) #(151 215 11) #(151 215 11) #(107 163 63) #(107 163 63)))
	(29 "Royal Blue" (#(75 71 227) #(75 71 227) #(47 47 199) #(47 47 199) #(27 27 175) #(27 27 175) #(11 11 147) #(11 11 147)))
	(30 "Passion" (#(211 39 103) #(211 39 103) #(199 7 83) #(199 7 83) #(171 7 71) #(171 7 71) #(143 11 63) #(143 11 63)))
	(31 "Bliss Red" (#(239 127 159) #(239 127 159) #(227 79 127) #(227 79 127) #(211 39 103) #(211 39 103) #(199 7 83) #(199 7 83)))
	(32 "Blush Pink" (#(255 227 207) #(255 227 207) #(255 175 195) #(255 175 195) #(239 127 159) #(239 127 159) #(227 79 127) #(227 79 127)))
	(33 "Twilight Sigh" (#(235 187 235) #(235 187 235) #(215 163 207) #(215 163 207) #(195 143 183) #(195 143 183) #(179 123 159) #(179 123 159)))
	(34 "Dreamer Blue" (#(103 99 255) #(103 99 255) #(103 99 255) #(103 99 255) #(75 71 227) #(75 71 227) #(47 47 199) #(47 47 199)))
	(35 "Shadow Gray" (#(143 111 155) #(143 111 155) #(123 91 135) #(123 91 135) #(103 71 115) #(103 71 115) #(79 67 67) #(79 67 67)))
	(36 "Neutral Gray" (#(163 135 175) #(163 135 175) #(143 111 155) #(143 111 155) #(123 91 135) #(123 91 135) #(103 71 115) #(103 71 115)))
	(37 "Tragic Gray" (#(183 163 195) #(183 163 195) #(163 135 175) #(163 135 175) #(143 111 155) #(143 111 155) #(123 91 135) #(123 91 135)))
	(38 "Winter Gray" (#(203 199 239) #(203 199 239) #(175 171 223) #(175 171 223) #(151 143 207) #(151 143 207) #(135 115 191) #(135 115 191)))
	(39 "Indigo" (#(63 47 111) #(63 47 111) #(51 39 99) #(51 39 99) #(43 31 91) #(43 31 91) #(43 31 91) #(43 31 91)))))
     
     (color-table-5 ;; Used for vest, bracers, cape, boots and trousers.
      '((0 "Blood Red" (#(199 23 23) #(199 23 23) #(171 11 11) #(171 11 11) #(143 7 7) #(143 7 7) #(99 0 0) #(99 0 0)))
	(1 "Courage Red" (#(255 55 55) #(255 55 55) #(227 39 39) #(227 39 39) #(199 23 23) #(199 23 23) #(171 11 11) #(171 11 11)))
	(2 "Merry Red" (#(255 55 55) #(255 55 55) #(255 55 55) #(255 55 55) #(255 55 55) #(255 55 55) #(227 39 39) #(227 39 39)))
	(3 "Ember Orange" (#(243 163 107) #(243 163 107) #(235 135 63) #(235 135 63) #(255 95 27) #(255 95 27) #(187 91 23) #(187 91 23)))
	(4 "Hearty Brown" (#(171 7 71) #(171 7 71) #(143 11 63) #(143 11 63) #(111 7 47) #(111 7 47) #(75 23 23) #(75 23 23)))
	(5 "Burnt Orange" (#(187 91 23) #(187 91 23) #(163 71 7) #(163 71 7) #(139 55 0) #(139 55 0) #(111 51 51) #(111 51 51)))
	(6 "Busy Orange" (#(235 135 63) #(235 135 63) #(211 111 39) #(211 111 39) #(187 91 23) #(187 91 23) #(163 71 7) #(163 71 7)))
	(7 "August Orange" (#(247 195 155) #(247 195 155) #(243 163 107) #(243 163 107) #(235 135 63) #(235 135 63) #(211 111 39) #(211 111 39)))
	(8 "Noble Brown" (#(171 111 79) #(171 111 79) #(155 103 79) #(155 103 79) #(147 95 79) #(147 95 79) #(123 63 63) #(123 63 63)))
	(9 "Mahogany" (#(171 91 103) #(171 91 103) #(151 59 75) #(151 59 75) #(131 35 47) #(131 35 47) #(115 15 27) #(115 15 27)))
	(10 "Clever Maize" (#(199 159 51) #(199 159 51) #(175 135 39) #(175 135 39) #(155 111 27) #(155 111 27) #(107 95 19) #(107 95 19)))
	(11 "Pure Gold" (#(251 235 183) #(251 235 183) #(247 223 135) #(247 223 135) #(243 215 91) #(243 215 91) #(219 187 71) #(219 187 71)))
	(12 "Moon Yellow" (#(255 251 235) #(255 251 235) #(251 235 183) #(251 235 183) #(251 235 183) #(251 235 183) #(247 223 135) #(247 223 135)))
	(13 "Sun Yellow" (#(255 251 235) #(255 251 235) #(251 235 183) #(251 235 183) #(255 239 7) #(255 239 7) #(219 187 71) #(219 187 71)))
	(14 "Tan" (#(183 195 115) #(183 195 115) #(175 151 79) #(175 151 79) #(175 151 79) #(175 151 79) #(159 139 63) #(159 139 63)))
	(15 "Woodland Green" (#(95 143 47) #(95 143 47) #(79 123 31) #(79 123 31) #(67 103 19) #(67 103 19) #(55 83 11) #(55 83 11)))
	(16 "Friendly Green" (#(111 175 91) #(111 175 91) #(95 155 67) #(95 155 67) #(79 139 47) #(79 139 47) #(63 119 31) #(63 119 31)))
	(17 "Lucky Green" (#(163 223 131) #(163 223 131) #(131 195 115) #(131 195 115) #(111 175 91) #(111 175 91) #(95 155 67) #(95 155 67)))
	(18 "Travelers Green" (#(163 223 131) #(163 223 131) #(163 223 131) #(163 223 131) #(151 215 11) #(151 215 11) #(123 183 83) #(123 183 83)))
	(19 "Aquacyan" (#(0 135 139) #(0 135 139) #(0 135 139) #(0 135 139) #(0 135 139) #(0 135 139) #(71 111 163) #(71 111 163)))
	(20 "Deepsea Blue" (#(71 111 163) #(71 111 163) #(43 87 143) #(43 87 143) #(23 67 119) #(23 67 119) #(7 51 99) #(7 51 99)))
	(21 "Proud Blue" (#(103 139 187) #(103 139 187) #(71 111 163) #(71 111 163) #(43 87 143) #(43 87 143) #(23 67 119) #(23 67 119)))
	(22 "Lightsky Blue" (#(183 203 231) #(183 203 231) #(143 171 207) #(143 171 207) #(103 139 187) #(103 139 187) #(71 111 163) #(71 111 163)))
	(23 "Syndira Blue" (#(103 99 255) #(103 99 255) #(0 0 0) #(0 0 0) #(0 0 0) #(0 0 0) #(47 47 199) #(47 47 199)))
	(24 "Straight Blue" (#(47 47 199) #(47 47 199) #(27 27 175) #(27 27 175) #(11 11 147) #(11 11 147) #(0 0 123) #(0 0 123)))
	(25 "Royal Purple" (#(147 63 167) #(147 63 167) #(127 35 147) #(127 35 147) #(111 15 127) #(111 15 127) #(63 55 55) #(63 55 55)))
	(26 "Lonely Orchid" (#(183 127 203) #(183 127 203) #(163 91 183) #(163 91 183) #(147 63 167) #(147 63 167) #(127 35 147) #(127 35 147)))
	(27 "Spiritual Purple" (#(235 215 243) #(235 215 243) #(207 167 223) #(207 167 223) #(183 127 203) #(183 127 203) #(163 91 183) #(163 91 183)))
	(28 "Mad Green" (#(243 239 159) #(243 239 159) #(151 215 11) #(151 215 11) #(151 215 11) #(151 215 11) #(107 163 63) #(107 163 63)))
	(29 "Royal Blue" (#(75 71 227) #(75 71 227) #(47 47 199) #(47 47 199) #(27 27 175) #(27 27 175) #(11 11 147) #(11 11 147))))))
  
  (flet
      ((color-table (keyword)
	 (case keyword
	   ((:fur :markings)                        color-table-1)
	   (:hair                                   color-table-2)
	   (:eyes                                   color-table-3)
	   (:badge                                  color-table-4)
	   ((:vest :bracers :cape :boots :trousers) color-table-5)
	   (otherwise (error "Keyword not matching any of:
:FUR :MARKINGS :HAIR :EYES :BADGE :VEST :BRACERS :CAPE :BOOTS :TROUSERS")))))
    
    (defun color-string-char (keyword string)
      "This, given a keyword designating a color-code slot and a color name, returns a proper
character for the color code."
      (check-type string string)
      (check-type keyword keyword)
      (iterate (for color in (color-table keyword))
	       (when (string= string (second color))
		 (return (coerce (to-220 (first color)) 'character)))))

    (defun color-char-string (keyword char)
      "This, given a keyword designating a color-code slot and a character for the color code,
returns a proper color name."
      (check-type char character)
      (check-type keyword keyword)
      (iterate (for color in (color-table keyword))
	       (when (eq (from-220 (string char)) (first color))
		 (return (second color)))))))


